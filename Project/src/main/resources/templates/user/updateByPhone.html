<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>번호 수정</title>
</head>
<body>
	<h1>번호 수정</h1>
    
    <form action="updateUserPhone" method="post" onsubmit="return checkPhone()">  
        <input type="text" id="afterPhone" name="afterPhone" th:placeholder="${beforePhone}" oninput="checkSamePhone()">
        <input type="submit" id="submitButton" value="수정">
    </form>
    
    <table>
        <tr>
            <td>
                <div id="checkError" style="color: red; display: none;"></div>
                <div id="beforePhone" th:text="${beforePhone}" style="display: none;"></div>
                <div id="msg" th:text="${msg}" style="display: none;"></div>
            </td>
        </tr>
    </table>

    <script>
    
    var submitButton = document.getElementById("submitButton");
    
        function checkSamePhone() {
            var afterPhone = document.getElementById("afterPhone").value;
            var beforePhone = document.getElementById("beforePhone").innerText;
            var checkError = document.getElementById("checkError");

            if (afterPhone === beforePhone) {
                checkError.innerText = "기존에 사용하던 번호를 입력하셨습니다.";
                checkError.style.display = "block";
                document.getElementById("afterPhone").style.border = "1px solid red";
                submitButton.disabled = true;
            } else {
                checkError.innerText = "";
                checkError.style.display = "none";
                document.getElementById("afterPhone").style.border = "1px solid black";
                submitButton.disabled = false;
            }
        }
    
        function checkPhone() {
            var afterPhone = document.getElementById("afterPhone").value;
            var checkError = document.getElementById("checkError");
            var submitButton = document.getElementById("submitButton");

            if (afterPhone.trim() === "") {
                checkError.innerText = "번호를 입력해주세요.";
                checkError.style.display = "block";
                document.getElementById("afterPhone").style.border = "1px solid red";
                submitButton.disabled = true;
                return false;
            } else {
                submitButton.disabled = false;
            }

            return true;
        }
        
        function msg() {
    		var msgElement = document.getElementById("msg");
    		var msg = msgElement.innerText;

    		if(msg != '') {
    			alert(msg);
    		}
    	}
    	
    	msg();
    </script>
</body>
</html>